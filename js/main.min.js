var globalLanguageIndexConverter={javascript:0,ruby:1,java:2,php:3,python:4,"c++":5,c:6,"objective-c":7,"c#":8,shell:9,css:10,perl:11,coffeescript:12,viml:13,scala:14,go:15,prolog:16,clojure:17,haskell:18,lua:19};
var globalFormattedLanguageIndices={JavaScript:0,Ruby:1,Java:2,PHP:3,Python:4,"C++":5,C:6,"Objective-C":7,"C#":8,Shell:9,CSS:10,Perl:11,CoffeeScript:12,VimL:13,Scala:14,Go:15,Prolog:16,Clojure:17,Haskell:18,Lua:19};
initialize();function initialize(){var a=new XMLHttpRequest();var b={callType:"init"};a.open("POST","backend/main.php",true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");
a.send("data="+JSON.stringify(b));a.onload=function(){if(a.status>=200&&a.status<400){b=JSON.parse(a.responseText);parseMatrix(b.finals,b.totals);document.getElementById("vis3Loader").style.display="none";
}else{console.log("Oh noesz");}};}var totalSum=0;function parseMatrix(k,w){var d=Object.keys(w);totalSum=0;for(var s=d.length-1;s>=0;s--){totalSum+=parseInt(w[d[s]]);
}var v=k;var e=Object.keys(v);var q=[];for(var s=0;s<e.length;s++){var x=[];var c=Object.keys(v[e[s]]);for(var r=0;r<c.length;r++){x[globalLanguageIndexConverter[c[r]]]=parseInt(v[e[s]][c[r]]);
}q.push(x);}var l=d3.layout.chord().padding(0.05).sortSubgroups(d3.descending).matrix(q);var m=1000,f=1100,a=Math.min(m,f)*0.41,n=a*1.1;r1=a;r0=n;var p=d3.scale.category20();
var h=d3.select("#vis3").append("svg").attr("width",m).attr("height",f).append("g").attr("transform","translate("+m/2+","+f/2+")");var b=d3.svg.arc();h.append("g").selectAll("path").data(l.groups).enter().append("path").style("fill",function(g){return p(g.index);
}).style("stroke",function(g){return p(g.index);}).attr("d",b.innerRadius(a).outerRadius(n)).on("mouseover",o(0.1)).on("mouseout",o(1));h.append("g").attr("class","chord").selectAll("path").data(l.chords).enter().append("path").attr("d",d3.svg.chord().radius(a)).style("fill",function(g){return p(g.target.index);
}).style("opacity",1).on("mouseover",function(g){d3.select("#tooltip").style("visibility","visible").html(getTooltip(g,totalSum)).style("top",function(){return(d3.event.pageY-50)+"px";
}).style("left",function(){return(d3.event.pageX-100)+"px";});o(0.1);}).on("mouseout",function(){d3.select("#tooltip").style("visibility","hidden");o(1);
});var u=h.selectAll("g.group").data(l.groups).enter().append("svg:g").attr("class","group").on("mouseover",o(0.02)).on("mouseout",o(0.8));u.append("svg:path").style("stroke",function(g){return p(g.index);
}).style("fill",function(g){return p(g.index);}).attr("d",b);u.append("svg:text").each(function(g){g.angle=(g.startAngle+g.endAngle)/2;}).attr("dy",".35em").attr("text-anchor",function(g){return g.angle>Math.PI?"end":null;
}).attr("transform",function(g){return"rotate("+(g.angle*180/Math.PI-90)+")translate("+(r0+26)+")"+(g.angle>Math.PI?"rotate(180)":"");}).text(function(g){return getFormattedLanguageString(g.index);
});function t(j){var g=(j.endAngle-j.startAngle)/j.value;return d3.range(0,j.value,1000).map(function(y,z){return{angle:y*g+j.startAngle,label:z%5?null:y/1000+"k"};
});}function o(g){return function(y,j){h.selectAll(".chord path").filter(function(z){return z.source.index!=j&&z.target.index!=j;}).transition().style("opacity",g);
};}}function getLanguageString(a){var b=Object.keys(globalLanguageIndexConverter);return b[a];}function getFormattedLanguageString(a){var b=Object.keys(globalFormattedLanguageIndices);
return b[a];}function getTooltip(c,b){var a=getFormattedLanguageString(c.source.index)+" - "+getFormattedLanguageString(c.source.subindex)+"<br />";a+="Users: "+c.source.value+"("+((c.source.value/b)*100).toFixed(2)+"%)";
return a;}document.getElementById("usernameSearch").addEventListener("click",function(){var a=new XMLHttpRequest();var b={callType:"usernameSearch",username:document.getElementById("usernameField").value};
a.open("POST","backend/main.php",true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");a.send("data="+JSON.stringify(b));
a.onload=function(){if(a.status>=200&&a.status<400){var e=JSON.parse(a.responseText);var d=document.getElementsByClassName("cardSec");for(var c=d.length-1;
c>=0;c--){d[c].style.opacity=0.1;d[c].style.color="#000";}for(var c=e.length-1;c>=0;c--){document.getElementById(e[c]+"Sec").style.opacity=1;document.getElementById(e[c]+"Sec").style.color="#2ecc71";
}}else{console.log("Oh noesz");}};});document.getElementById("languageSearch").addEventListener("click",function(){var a=document.getElementsByClassName("langSec");
var e=[];for(var b=0;b<a.length;b++){if(a[b].classList.contains("langSelected")){e.push(a[b].id.replace("Lang",""));}}var d={callType:"languageSearchLimited",languages:e};
var c=new XMLHttpRequest();c.open("POST","backend/main.php",true);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");
var f=JSON.stringify(d);c.send("data="+JSON.stringify(d));c.onload=function(){if(c.status>=200&&c.status<400){var g=JSON.parse(c.responseText);drawUserLanguageTable(g);
drawUserLanguagePieChart(g);}else{console.log("Oh noesz");}};});function drawUserLanguageTable(f){var d=document.getElementById("languageSearchResultsBody");
d.innerHTML="";var a=document.createDocumentFragment();var c=f.total;var f=f.users;for(var b=0;b<f.length;b++){var e=document.createElement("tr");var g=document.createElement("td");
g.innerHTML="<a href='https://github.com/"+f[b]+"' >"+f[b]+"</a>";e.appendChild(g);a.appendChild(e);}d.appendChild(a);document.getElementById("languageSearchResults").style.display="block";
if(c>f.length){document.getElementById("fetchMoreButton").style.display="block";}}function drawUserLanguagePieChart(d){document.getElementById("languageUserSearch").innerHTML="";
var k=[{name:"Selection",number:parseInt(d.total),colorIndex:0},{name:"Other",number:totalSum,colorIndex:1}];var a=500,l=300,j=Math.min(a,l)/2;var c=d3.scale.ordinal().range(["#2ecc71","#e74c3c"]);
var b=d3.svg.arc().outerRadius(j-10).innerRadius(0);var e=d3.layout.pie().sort(null).value(function(g){return g.number;});var f=d3.select("#languageUserSearch").append("svg").attr("width",a).attr("height",l).append("g").attr("transform","translate("+a/2+","+l/2+")");
k.forEach(function(g){g.number=+g.number;});var h=f.selectAll(".pie_arc").data(e(k)).enter().append("g").attr("class","pie_arc");h.append("path").attr("d",b).style("fill",function(g){return c(g.data.colorIndex);
}).style("stroke",function(){return"#fff";}).on("mouseover",function(){d3.select(this).style("stroke",function(){return"#000";});}).on("mouseout",function(){d3.select(this).style("stroke",function(){return"none";
});});h.append("text").attr("transform",function(g){return"translate("+b.centroid(g)+")";}).attr("dy",".35em").style("text-anchor","middle").text(function(g){return g.data.name;
});}var langList=document.getElementsByClassName("langSec");for(var i=langList.length-1;i>=0;i--){langList[i].addEventListener("click",function(){toggleLangSelection(this);
});}function toggleLangSelection(a){if(a.classList.contains("langSelected")){a.classList.remove("langSelected");}else{a.classList.add("langSelected");}}document.getElementById("fetchMoreButton").addEventListener("click",function(){var a=document.getElementsByClassName("langSec");
var e=[];for(var b=0;b<a.length;b++){if(a[b].classList.contains("langSelected")){e.push(a[b].id.replace("Lang",""));}}var d={callType:"languageSearch",languages:e};
var c=new XMLHttpRequest();c.open("POST","backend/main.php",true);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");
var f=JSON.stringify(d);document.getElementById("languageLoader").style.display="block";c.send("data="+JSON.stringify(d));c.onload=function(){if(c.status>=200&&c.status<400){var g=JSON.parse(c.responseText);
drawUserLanguageTable(g);drawUserLanguagePieChart(g);document.getElementById("languageLoader").style.display="none";}else{console.log("Oh noesz");}};});
